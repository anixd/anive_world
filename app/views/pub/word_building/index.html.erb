<% content_for :title, "#{@language.name} Word-building" %>

<%= render 'pub/shared/search_block' %>

<div class="bg-white p-6 rounded-lg shadow-md">
  <div class="mb-6">
    <%= render 'pub/shared/breadcrumbs', crumbs: [
      { title: "Languages", path: pub_languages_path },
      { title: @language.name, path: pub_language_path(@language) },
      { title: "Word-building" }
    ] %>
  </div>

  <div class="border-b pb-4 mb-6">
    <h1 class="text-3xl font-bold"><%= @language.name %>: Word-building</h1>
    <p class="mt-1 text-gray-600">The basic components for constructing words.</p>
  </div>

  <div class="mb-6">
    <div class="flex rounded-lg border overflow-hidden">
      <%# Таб для Корней %>
      <%= link_to "Roots", url_for(tab: 'roots'),
                  class: "flex-1 py-2 px-4 text-center font-medium transition-colors #{ @active_tab == 'roots' ? 'bg-blue-600 text-white' : 'bg-gray-50 text-gray-700 hover:bg-gray-100' }" %>

      <%# Таб для Аффиксов %>
      <%= link_to "Affixes", url_for(tab: 'affixes'),
                  class: "flex-1 py-2 px-4 text-center font-medium transition-colors #{ @active_tab == 'affixes' ? 'bg-blue-600 text-white' : 'bg-gray-50 text-gray-700 hover:bg-gray-100' }" %>
    </div>
  </div>

  <div>
    <% if @active_tab == 'roots' %>
      <%# -- roots -- %>
      <%= render "shared/pagination_controls", pagy: @pagy %>
      <section class="mt-4">
        <div class="flex flex-col">
          <% if @roots.any? %>
            <% @roots.each do |root| %>
              <%= link_to pub_language_root_path(@language, root), class: "block py-3 border-b hover:bg-gray-50 group" do %>
                <h3 class="font-bold text-lg font-mono text-blue-800 group-hover:underline"><%= root.text %></h3>
                <div class="prose prose-sm max-w-none text-gray-700 mt-1" data-controller="wikilink-preview">
                  <%= render_markdown(root.meaning.to_s) %>
                </div>
              <% end %>
            <% end %>
          <% else %>
            <p class="text-gray-500 italic">No published roots for this language yet.</p>
          <% end %>
        </div>
      </section>

    <% elsif @active_tab == 'affixes' %>
      <%# -- affixes -- %>
      <%= render "shared/pagination_controls", pagy: @pagy %>
      <section class="mt-4">
        <div class="flex flex-col">
          <% if @affixes.any? %>
            <% @affixes.each do |affix| %>
              <%= link_to pub_language_affix_path(@language, affix), class: "block py-3 border-b hover:bg-gray-50 group" do %>
                <div class="flex items-baseline gap-3">
                  <h3 class="font-bold text-lg font-mono text-green-800 group-hover:underline"><%= affix.text %></h3>
                  <span class="text-xs font-semibold uppercase text-gray-500"><%= affix.affix_type %></span>
                </div>
                <div class="prose prose-sm max-w-none text-gray-700 mt-1" data-controller="wikilink-preview">
                  <%= render_markdown(affix.meaning.to_s) %>
                </div>
              <% end %>
            <% end %>
          <% else %>
            <p class="text-gray-500 italic">No published affixes for this language yet.</p>
          <% end %>
        </div>
      </section>
    <% end %>

    <div class="mt-6">
      <%= render "shared/pagination_controls", pagy: @pagy %>
    </div>
  </div>
</div>
